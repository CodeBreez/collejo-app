{"version":3,"sources":["collejo.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"collejo.js","sourcesContent":["var Collejo = Collejo || {\n    settings: {\n        alertInClass: 'bounceInDown',\n        alertOutClass: 'fadeOutUp'\n    },\n    templates: {},\n    form: {},\n    link: {},\n    modal: {}\n};\n\nCollejo.ajaxComplete = function(event, xhr, settings) {\n\n    var code, status, timeout, response = 0;\n\n    try {\n        response = $.parseJSON(xhr.responseText);\n    } catch (e) {\n        console.log(e)\n    }\n\n    status = (response == 0) ? xhr.status : response;\n\n    if (status == 403 || status == 401) {\n        Collejo.alert('danger', 'You are not authorized to perform this action', 1000);\n    }\n\n    if (status != 0 && status != null) {\n        var code = status.code != undefined ? status.code : 0;\n        if (code == 0) {\n            if (response.data != undefined && response.data.redir != undefined) {\n                if (response.message != null) {\n                    Collejo.alert(response.success ? 'success' : 'warning', response.message + '. redirecting&hellip;', 1000);\n                    timeout = 0;\n                }\n                setTimeout(function() {\n                    window.location = response.data.redir;\n                }, timeout);\n            }\n\n            if (response.message != undefined && response.message != null && response.message.length > 0 && response.data.redir == undefined) {\n                Collejo.alert(response.success ? 'success' : 'warning', response.message, 3000);\n            }\n\n            if (response.data != undefined && response.data.errors != undefined) {\n                var msg = '<strong>Validation failed</strong> Please correct them and try again <br/>';\n                $.each(response.data.errors, function(field, err) {\n                    $.each(err, function(i, e) {\n                        msg = msg + e + '<br/>';\n                    });\n                });\n\n                Collejo.alert('warning', msg, 5000);\n            }\n        }\n    }\n\n    $(window).resize();\n}\n\n$(function() {\n\n    Collejo.templates.spinnerTemplate = function() {\n        return $('<span class=\"spinner-wrap\"><span class=\"spinner\"></span></span>');\n    }\n\n    Collejo.templates.alertTemplate = function(type, message, duration) {\n        return $('<div class=\"alert alert-' + type + ' ' + (duration !== false ? 'alert-dismissible' : '') + '\" role=\"alert\">' +\n            (duration !== false ? '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">' +\n                '<span aria-hidden=\"true\">&times;</span></button>' : '') + message + '</div>');\n    }\n\n    Collejo.templates.alertWrap = function() {\n        return $('<div id=\"alert-wrap\"></div>');\n    }\n\n    Collejo.templates.alertContainer = function() {\n        return $('<div class=\"alert-container\"></div>');\n    }\n\n    Collejo.templates.ajaxLoader = function() {\n        return null;\n    }\n\n    Collejo.alert = function(type, msg, duration) {\n        var alertWrap = Collejo.templates.alertWrap();\n        var alertContainer = Collejo.templates.alertContainer();\n\n        alertWrap.css({\n            position: 'fixed',\n            top: 0,\n            width: '100%',\n            height: 0\n        });\n\n        alertContainer.css({\n            width: '400px',\n            margin: '0 auto'\n        });\n\n        alertWrap.append(alertContainer);\n        var alert = Collejo.templates.alertTemplate(type, msg, duration);\n\n        if ($('#alert-wrap').length == 0) {\n            $('body').append(alertWrap);\n        }\n\n        var alertContainer = $('#alert-wrap').find('.alert-container');\n\n        if (duration === false) {\n            alertContainer.empty();\n        }\n\n        alert.appendTo(alertContainer).addClass('animated ' + Collejo.settings.alertInClass);\n\n        if (duration > 0) {\n            window.setTimeout(function() {\n                alert.removeClass(Collejo.settings.alertInClass)\n                    .addClass(Collejo.settings.alertOutClass)\n                    .one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n                        alert.remove();\n                    });\n            }, duration);\n        }\n    }\n\n    Collejo.form.lock = function(form) {\n        $(form).find('button[type=\"submit\"]').attr('disabled', true).append(Collejo.templates.spinnerTemplate());\n    }\n\n    Collejo.form.unlock = function(form) {\n        $(form).find('button[type=\"submit\"]').attr('disabled', false).find('.spinner-wrap').remove();\n    }\n\n    Collejo.getView = function(url, callback) {\n        $.ajax({\n            dataType: 'json',\n            url: url,\n            cache: false,\n            success: callback\n        });\n    }\n\n    Collejo.link.ajax = function(link) {\n        link.attr('disabled', true).append(Collejo.templates.spinnerTemplate());\n\n        Collejo.getView(link.attr('href'), function(response) {\n            if (response.success) {\n                if (link.data('target')) {\n                    $('#' + link.data('target')).empty().append(response.data.html);\n                } else {\n                    link.replaceWith(response.data.html);\n                }\n            }\n        });\n    }\n\n    Collejo.modal.open = function(link) {\n        var id = link.data('modal-id') != null ? link.data('modal-id') : 'ajax-modal' + moment();\n        var size = link.data('modal-size') != null ? ' modal-' + link.data('modal-size') + ' ' : '';\n\n        var backdrop = link.data('modal-backdrop') != null ? link.data('modal-backdrop') : true;\n        var keyboard = link.data('modal-keyboard') != null ? link.data('modal-keyboard') : true;\n\n        var modal = $('<div id=\"' + id + '\" class=\"modal fade loading\" role=\"dialog\" aria-labelledby=\"' + id + '\" aria-hidden=\"true\"><div class=\"modal-dialog' + size + '\"></div></div>');\n\n        var loader = this.templates.ajaxLoader;\n\n        if (loader != null) {\n            loader.appendTo(modal);\n        }\n\n        $('body').append(modal);\n\n        modal.on('show.bs.modal', function() {\n            $.ajax({\n                url: link.attr('href'),\n                type: 'get',\n                success: function(response) {\n                    if (response.success == undefined) {\n                        modal.find('.modal-dialog').html(response);\n                        modal.removeClass('loading');\n\n                        if (loader != null) {\n                            loader.remove();\n                        }\n                    }\n                }\n            });\n        }).on('hidden.bs.modal', function() {\n            $(this).remove();\n        }).modal({\n            backdrop: backdrop,\n            keyboard: keyboard\n        });\n    }\n\n    Collejo.modal.close = function(form) {\n        $('body').find(form).closest('.modal').modal('hide').remove();\n    }\n\n    $(document).ajaxComplete(Collejo.ajaxComplete);\n\n    $(document).on('click', '[data-toggle=\"ajax-link\"]', function(e) {\n        e.preventDefault();\n        Collejo.link.ajax($(this));\n    });\n\n    $(document).on('click', '[data-toggle=\"ajax-modal\"]', function(e) {\n        e.preventDefault();\n        Collejo.modal.open($(this));\n    });\n\n    $(document).on('click', '[data-toggle=\"ajax-modal\"]', function(e) {\n        e.preventDefault();\n        Collejo.modal.open($(this));\n    });\n});\n\n$.ajaxSetup({\n    headers: {\n        'X-CSRF-Token': $('meta[name=\"token\"]').attr('content')\n    }\n});"],"sourceRoot":"/source/"}